'
' ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออปบ
'บ Library......: PBSTR   .INC                                           บบ
'บ Definition...:                                                        บบ
'บ Author.......:                                                        บบ
'บ Date.........: 04-18-1992                                             บบ
'บ Notice.......:                                                        บบ
'บ Notes........:                                                        บบ
'บ Reserved.....:                                                        บบ
'บ Function.....:                                                        บบ
'บ Version......:                                                        บบ
'บ History......:                                                        บบ
'บ Library......:                                                        บบ
'บ Compile......:                                                        บบ
'บ Link.........:                                                        บบ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนบ
'บ OBSERVATIONS:                                                         บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บน
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนบ
'บ FUNCTIONs..:                                                          บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บบ
'บ                                                                       บผ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ FUNCTION :trim$                                          04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    var$           ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ    trim$          ===>                                                บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
function trim$(var$)
     trim$ = ltrim$( rtrim$( var$ ))
     'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
     'บ END FUNCTION:trim$                                       04-18-1992   บ
     'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end function





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ FUNCTION :ctrim$                                         04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    var$           ===>                                                บ
'บ    cstring$       ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ    ctrim$         ===>                                                บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
function ctrim$( var$, cstring$ )
     ctrim$ = ltrim$( rtrim$(var$, any cstring$), any cstring$ )
     'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
     'บ END FUNCTION:ctrim$                                      04-18-1992   บ
     'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end function





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ SUB :splitvarfn                                          04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    var$           ===>                                                บ
'บ    comma$         ===>                                                บ
'บ    var$()         ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
sub splitvarfn( var$, comma$, var$() )
   local lenvar%
   local p%
   local r%
   local i%
    lenvar% = len(var$)
    

    if lenvar% > 0 then
       i% = 1
       

       do
          incr p%
          c% = instr( i%, var$+comma$, comma$ )
          

          if c% then
             var$(p%) = trim$(mid$(var$,i%,c%-i%))
             i% = c%+1
          end if
          
       loop until c% >= lenvar%

       
       var$(p%+1) = ""			' make end
    end if
    
    'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
    'บ END SUB:splitvarfn                                       04-18-1992   บ
    'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end sub





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ FUNCTION :rinstr                                         04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    iv%            ===>                                                บ
'บ    var$           ===>                                                บ
'บ    s$             ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ    rinstr         ===>                                                บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
function rinstr( iv%, var$, s$ )
    local p%
    local lvar%
    local ls%
     
     lvar% = len(var$)		' len of string where search
     ls% = len(s$)		' len of search string
     if iv% > 0 then lvar% = iv%
     

     if lvar% > 0 and ls% > 0 then
        

        do
           p% = instr(c%+1, left$(var$,lvar%)+s$, s$)
           

           if p% < lvar% then
              c% = p%
           else
              if c% > 0 then rinstr = c%
              exit loop
           end if
           
        loop while -1

        
     end if
     
     'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
     'บ END FUNCTION:rinstr                                      04-18-1992   บ
     'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end function





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ DEF FN:dia$                                              04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    d%             ===>                                                บ
'บ    m%             ===>                                                บ
'บ    y%             ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
def fndia$(d%,m%,y%)
   local n
   local dia$()
    

     redim dia$(0:6)
    
    dia$(0) = " Lunes "
    dia$(1) = " Martes "
    dia$(2) = " Miercoles "
    dia$(3) = " Jueves "
    dia$(4) = " Viernes "
    dia$(5) = " Sabado "
    dia$(6) = " Domingo "
    if mes% < 3 then mes%=mes%+12
    y%=y%-1
    n = d%+2*m%+int(.6*(m%+1))+y%+int(y%/4)-int(y%/100)+int(y%/400)+  2
    n = int((n/7-int(n/7))*7+.5)
    fndia$ = dia$(n)
    'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
    'บ END DEF:dia$                                             04-18-1992   บ
    'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end def





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ DEF FN:mes$                                              04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    mes%           ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
def fnmes$(mes%)
    

    select case mes%
     case  1
       fnmes$ = " Enero "
     case  2
       fnmes$ = " Febrero "
     case  3
       fnmes$ = " Marzo "
     case  4
       fnmes$ = " Abril "
     case  5
       fnmes$ = " Mayo "
     case  6
       fnmes$ = " Junio "
     case  7
       fnmes$ = " Julio "
     case  8
       fnmes$ = " Agosto "
     case  9
       fnmes$ = " Septiembre "
     case  10
       fnmes$ = " Octubre "
     case  11
       fnmes$ = " Noviembre "
     case  12
       fnmes$ = " Diciembre "
    end select

    
    'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
    'บ END DEF:mes$                                             04-18-1992   บ
    'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end def





function str.int2chr$( num% )
     
     str.int2chr$ = ltrim$(str$( num% ))
     
end function





function str.lng2chr$( num )
     
     str.lng2chr$ = ltrim$(str$( num ))
     
end function





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ SUB :str.dbase.color.fn                                  04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    mfgc$          ===>                                                บ
'บ    mbgc$          ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
'sub str.dbase.color.fn( attr%, mfgc$, mbgc$ )
'     call scr.attr2all.fn( attr%, fgc%, bgc%, inten%, blink% )
'    if inten% then  mint$ = "+"
'    if blink% then  mbli$ = "*"
'    mfgc$ = ltrim$(str$(fgc%))+mint$+mbli$
'    mbgc$ = ltrim$(str$(bgc%))
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ END SUB:str.dbase.color.fn                               04-18-1992   บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
'end sub

'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ SUB :str.dbase.clipper.fn                                04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    mfgc$          ===>                                                บ
'บ    mbgc$          ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
sub str.clipper.color.fn( attr%, mfgc$, mbgc$ )
   static clipper.color$()
    

    if clipper.color$(0) = "" then
       

        dim clipper.color$(0:7)
       
       clipper.color$(0) = "N"
       clipper.color$(1) = "B"
       clipper.color$(2) = "G"
       clipper.color$(3) = "BG"
       clipper.color$(4) = "R"
       clipper.color$(5) = "RB"
       clipper.color$(6) = "GR"
       clipper.color$(7) = "W"
    end if
    
     call scr.attr2all.fn( attr%, fgc%, bgc%, inten%, blink% )
    mfgc$ = clipper.color$(fgc%)
    if inten% then  mfgc$ = mfgc$ + "+"
    mbgc$ = clipper.color$(bgc%)
    if blink% then  mfgc$ = mfgc$ + "*"
    'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
    'บ END SUB:str.dbase.clipper.fn                             04-18-1992   บ
    'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end sub





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ SUB :str.basic.color.fn                                  04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    attr%          ===>                                                บ
'บ    mfgc$          ===>                                                บ
'บ    mbgc$          ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
sub str.basic.color.fn( attr%, mfgc$, mbgc$ )
     call scr.attr2color.fn( attr%, fgc%, bgc% )
    mfgc$ = ltrim$(str$(fgc%))
    mbgc$ = ltrim$(str$(bgc%))
    
    'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
    'บ END SUB:str.basic.color.fn                               04-18-1992   บ
    'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end sub





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ FUNCTION :str.rmcobol.attr$                              04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    attr%          ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ    str.rmcobol.att===>                                                บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
function str.rmcobol.attr$( attr% )
      call scr.attr2all.fn( attr%, fgc%, bgc%, inten%, blink% )
     

     if inten% then
        mint$ = "HIGH, "
     else
        mint$ = "LOW, "
     end if
     
     if blink% then mbli$ = "BLINK, "
     if bgc% <> 0 then mrev$ = "REVERSE, "
     str.rmcobol.attr$ = mint$+ mbli$+ mrev$
     'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
     'บ END FUNCTION:str.rmcobol.attr$                           04-18-1992   บ
     'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end function





'
'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
'บ FUNCTION :str.mscobol.attr$                              04-18-1992   บ
'ฬอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออน
'บ ACTION:                                                               บ
'บ                                                                       บ
'บ                                                                       บ
'บ TO PASS:                                                              บ
'บ    attr%          ===>                                                บ
'บ                                                                       บ
'บ RETURN:                                                               บ
'บ    str.mscobol.att===>                                                บ
'บ                                                                       บ
'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
function str.mscobol.attr$( attr% )
      call scr.attr2all.fn( attr%, fgc%, bgc%, inten%, blink% )
     if inten% then mint$ = "HIGHLIGHT, "
     if blink% then mbli$ = "BLINK, "
     if bgc% <> 0 then mrev$ = "REVERSE-VIDEO, "
     str.mscobol.attr$ = mint$+ mbli$+ mrev$
     'ษอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออป
     'บ END FUNCTION:str.mscobol.attr$                           04-18-1992   บ
     'ศอออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผ
end function





